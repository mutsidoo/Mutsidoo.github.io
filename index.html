<!DOCTYPE html>
<html lang="da">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>TDele</title>
<link rel="icon" type="image/png" href="icon.png">

<script type="module">
import { initializeApp } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-app.js";
import { getAuth, GoogleAuthProvider, signInWithPopup, signOut } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-auth.js";
import { getFirestore, collection, addDoc, getDocs, query, orderBy } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-firestore.js";
import { getStorage, ref, uploadBytes, getDownloadURL } from "https://www.gstatic.com/firebasejs/12.9.0/firebase-storage.js";

const firebaseConfig = {
  apiKey: "AIzaSyC4DdtJz-u3wBnP39aY61h-LcZcb-2lHkc",
  authDomain: "tdele-8e7b9.firebaseapp.com",
  projectId: "tdele-8e7b9",
  storageBucket: "tdele-8e7b9.firebasestorage.app",
  messagingSenderId: "144290683842",
  appId: "1:144290683842:web:0b0469105d7ffcae20d45b"
};

const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);
const storage = getStorage(app);

window.login = async function() {
  const provider = new GoogleAuthProvider();
  await signInWithPopup(auth, provider);
}

window.logout = async function() {
  await signOut(auth);
}

window.addPost = async function() {
  const title = document.getElementById("title").value;
  const price = document.getElementById("price").value;
  const desc = document.getElementById("desc").value;
  const file = document.getElementById("image").files[0];

  let imageUrl = "";

  if (file) {
    const storageRef = ref(storage, "posts/" + Date.now() + "_" + file.name);
    await uploadBytes(storageRef, file);
    imageUrl = await getDownloadURL(storageRef);
  }

  await addDoc(collection(db, "posts"), {
    title, price, desc, imageUrl, created: new Date()
  });

  document.getElementById("title").value = "";
  document.getElementById("price").value = "";
  document.getElementById("desc").value = "";
  document.getElementById("image").value = "";

  loadPosts();
}

async function loadPosts() {
  const q = query(collection(db, "posts"), orderBy("created", "desc"));
  const snapshot = await getDocs(q);
  const postsDiv = document.getElementById("posts");
  postsDiv.innerHTML = "";

  snapshot.forEach(doc => {
    const data = doc.data();
    postsDiv.innerHTML += `
      <div class="card">
        ${data.imageUrl ? `<img src="${data.imageUrl}" class="post-img">` : ""}
        <div class="card-content">
          <h3>${data.title}</h3>
          <p>${data.desc}</p>
          <div class="price">${data.price} kr</div>
        </div>
      </div>
    `;
  });
}

loadPosts();
</script>

<style>
html { scroll-behavior: smooth; }

body {
  margin:0;
  font-family:-apple-system, BlinkMacSystemFont, sans-serif;
  background: linear-gradient(135deg,#0f172a,#1e293b);
  color:white;
}

header {
  display:flex;
  justify-content:space-between;
  align-items:center;
  padding:20px 40px;
  backdrop-filter: blur(20px);
  background: rgba(255,255,255,0.05);
  position:sticky;
  top:0;
  z-index:100;
}

.logo { height:50px; }

nav a {
  margin:0 10px;
  text-decoration:none;
  color:white;
  font-weight:500;
}

nav button {
  background: rgba(255,255,255,0.1);
  border:none;
  padding:8px 14px;
  border-radius:10px;
  color:white;
  cursor:pointer;
}

.hero {
  text-align:center;
  padding:100px 20px 60px;
}

.hero h1 {
  font-size:48px;
  margin-bottom:20px;
}

.hero p {
  font-size:20px;
  opacity:0.8;
}

.section {
  max-width:1100px;
  margin:80px auto;
  padding:0 20px;
}

.glass-box {
  backdrop-filter: blur(25px);
  background: rgba(255,255,255,0.07);
  padding:30px;
  border-radius:20px;
  border:1px solid rgba(255,255,255,0.1);
}

input, textarea {
  width:100%;
  padding:12px;
  margin:8px 0;
  border-radius:12px;
  border:none;
  background: rgba(255,255,255,0.1);
  color:white;
}

.post-btn {
  width:100%;
  padding:14px;
  border-radius:14px;
  border:none;
  background: linear-gradient(135deg,#3b82f6,#6366f1);
  color:white;
  font-weight:bold;
  cursor:pointer;
}

.grid {
  display:grid;
  grid-template-columns: repeat(auto-fill,minmax(280px,1fr));
  gap:20px;
  margin-top:30px;
}

.card {
  backdrop-filter: blur(20px);
  background: rgba(255,255,255,0.06);
  border-radius:20px;
  overflow:hidden;
  border:1px solid rgba(255,255,255,0.1);
}

.post-img {
  width:100%;
  height:200px;
  object-fit:cover;
}

.card-content { padding:20px; }

.price {
  font-size:20px;
  font-weight:bold;
  color:#60a5fa;
  margin-top:10px;
}

.about p {
  line-height:1.6;
  opacity:0.85;
}
</style>
</head>

<body>

<header>
  <img src="logo.png" class="logo">
  <nav>
    <a href="#browse">Browse</a>
    <a href="#about">Om</a>
    <button onclick="login()">Login</button>
    <button onclick="logout()">Log ud</button>
  </nav>
</header>

<section class="hero">
  <h1>Marketplace for Computer Dele</h1>
  <p>Køb og sælg hardware nemt, sikkert og simpelt.</p>
</section>

<section class="section glass-box">
  <h2>Opret annonce</h2>
  <input id="title" placeholder="lenovo ram 4GB">
  <input id="price" placeholder="Pris i kr">
  <textarea id="desc" placeholder="Beskrivelse"></textarea>
  <input type="file" id="image" accept="image/*">
  <button class="post-btn" onclick="addPost()">Opret annonce</button>
</section>

<section id="browse" class="section">
  <h2>Browse Annoncer</h2>
  <div class="grid" id="posts"></div>
</section>

<section id="about" class="section glass-box about">
  <h2>Om TDele</h2>
  <p>
    TDele blev skabt fordi der manglede en dedikeret marketplace kun for computerdele.
  </p>
  <p>
    T'et i TDele står for Thormod – ejeren og entusiasten bag platformen.
    Som passioneret tech-interesseret syntes han, at det var på tide
    med et sted hvor hardware kan handles nemt og samlet ét sted.
  </p>
  <p>
    TDele er bygget med fokus på simpelt design, gennemsigtighed og fællesskab.
  </p>
</section>

</body>
</html>
